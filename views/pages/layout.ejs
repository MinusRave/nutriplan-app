<!DOCTYPE html>
<html lang="<%= currentLang %>">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title><%= pageTitle %> - DietingWithJoe</title>
  <meta name="description" content="<%= t('app.description') %>">

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/images/favicon/favicon.svg">
  <link rel="manifest" href="/images/favicon/site.webmanifest">

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <!-- App CSS -->
  <link rel="stylesheet" href="/css/style-simple.css">
</head>
<body class="chat-inactive">
  <header class="app-header">
    <div class="brand">DietingWithJoe</div>
    <div class="header-actions">
      <div class="language-menu">
        <button id="language-btn" aria-label="<%= t('language.selector') %>">
          <%= currentLang.toUpperCase() %> <span class="chevron-down">▼</span>
        </button>
        <div class="language-dropdown hidden">
          <a href="/changelanguage/it?redirect=/" role="menuitem" class="<%= currentLang === 'it' ? 'active' : '' %>" lang="it">Italiano</a>
          <a href="/changelanguage/en?redirect=/" role="menuitem" class="<%= currentLang === 'en' ? 'active' : '' %>" lang="en">English</a>
          <a href="/changelanguage/fr?redirect=/" role="menuitem" class="<%= currentLang === 'fr' ? 'active' : '' %>" lang="fr">Français</a>
          <a href="/changelanguage/es?redirect=/" role="menuitem" class="<%= currentLang === 'es' ? 'active' : '' %>" lang="es">Español</a>
          <a href="/changelanguage/de?redirect=/" role="menuitem" class="<%= currentLang === 'de' ? 'active' : '' %>" lang="de">Deutsch</a>
          <a href="/changelanguage/pt?redirect=/" role="menuitem" class="<%= currentLang === 'pt' ? 'active' : '' %>" lang="pt">Português</a>
        </div>
      </div>
    </div>
  </header>

  <main class="app-container">
    <div class="page-header">
      <h1><%= pageTitle %></h1>
    </div>
    <div class="page-body">
      <%- pageContent %>
    </div>
    <div class="page-navigation">
      <a href="/" class="btn btn-secondary"><%= t('back_to_home') %></a>
    </div>
  </main>

  <footer>
    <div class="app-container" style="padding-top: 2rem; padding-bottom: 2rem;">
      <p>&copy; <%= new Date().getFullYear() %> <%= t('footer.copyright') %></p>
      <div class="footer-links">
        <a href="/privacy"><%= t('footer.privacy') %></a>
        <a href="/terms"><%= t('footer.terms') %></a>
        <a href="/contact"><%= t('footer.contact') %></a>
      </div>
    </div>
  </footer>

  <!-- Script lingua -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const langBtn = document.getElementById('language-btn');
      const dropdown = document.querySelector('.language-dropdown');

      if (langBtn && dropdown) {
        langBtn.addEventListener('click', function(e) {
          e.stopPropagation();
          dropdown.classList.toggle('hidden');
        });

        document.addEventListener('click', function(e) {
          if (!dropdown.contains(e.target) && !langBtn.contains(e.target)) {
            dropdown.classList.add('hidden');
          }
        });
      }
    });
  </script>
</body>
</html>
